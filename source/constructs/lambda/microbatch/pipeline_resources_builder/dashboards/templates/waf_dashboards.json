{
    "annotations":{
        "list":[
            {
                "builtIn":1,
                "datasource":{
                    "type":"grafana",
                    "uid":"-- Grafana --"
                },
                "enable":true,
                "hide":true,
                "iconColor":"rgba(0, 211, 255, 1)",
                "name":"Annotations & Alerts",
                "target":{
                    "limit":100,
                    "matchAny":false,
                    "tags":[

                    ],
                    "type":"dashboard"
                },
                "type":"dashboard"
            }
        ]
    },
    "editable":true,
    "fiscalYearStartMonth":0,
    "graphTooltip":0,
    "id":199,
    "links":[

    ],
    "liveNow":false,
    "panels":[
        {
            "collapsed":false,
            "gridPos":{
                "h":1,
                "w":24,
                "x":0,
                "y":0
            },
            "id":19,
            "panels":[

            ],
            "title":"Overview (updates based on top time selection)",
            "type":"row"
        },
        {
            "datasource":{
                "type":"grafana-athena-datasource",
                "uid":"Bn93a3_Vk"
            },
            "fieldConfig":{
                "defaults":{
                    "color":{
                        "fixedColor":"text",
                        "mode":"fixed"
                    },
                    "decimals":0,
                    "mappings":[

                    ],
                    "thresholds":{
                        "mode":"absolute",
                        "steps":[
                            {
                                "color":"green",
                                "value":null
                            },
                            {
                                "color":"red",
                                "value":80
                            }
                        ]
                    },
                    "unit":"short"
                },
                "overrides":[

                ]
            },
            "gridPos":{
                "h":6,
                "w":5,
                "x":0,
                "y":1
            },
            "id":2,
            "options":{
                "colorMode":"value",
                "graphMode":"none",
                "justifyMode":"center",
                "orientation":"auto",
                "reduceOptions":{
                    "calcs":[
                        "sum"
                    ],
                    "fields":"/^requests$/",
                    "values":false
                },
                "text":{

                },
                "textMode":"auto"
            },
            "pluginVersion":"10.0.0",
            "targets":[
                {
                    "connectionArgs":{
                        "catalog":"__default",
                        "database":"__default",
                        "region":"__default",
                        "resultReuseEnabled":true,
                        "resultReuseMaxAgeInMinutes":5
                    },
                    "datasource":{
                        "type":"grafana-athena-datasource",
                        "uid":"Bn93a3_Vk"
                    },
                    "format":1,
                    "rawSQL":"SELECT $__unixEpochGroup(time / 1000, '${interval}') as time, webaclid, webaclname, terminatingruleid, terminatingruletype, httpsourceid, httpmethod, country, clientip, first_label, uri, account_id, region, action, sum(requests) as requests\nFROM \"$__table\"\nWHERE account_id = ${account_id:sqlstring}\n\tAND region = ${region:sqlstring} \n\tAND action IN (${action:sqlstring}) \n\tAND terminatingruletype IN (${terminatingruletype:sqlstring})\n\tAND webaclname IN (${webaclname:sqlstring}) \n\tAND httpsourceid IN (${httpsourceid:sqlstring}) \n\tAND terminatingruleid IN (${terminatingruleid:sqlstring})\n\tAND $__unixEpochFilter(time / 1000)\n\tAND (event_hour BETWEEN  $__rawTimeFrom('yyyyMMddHH') AND  $__rawTimeTo('yyyyMMddHH')\n\tOR event_hour = $__rawTimeFrom('yyyyMMdd00'))\nGROUP BY $__unixEpochGroup(time / 1000, '${interval}'), webaclid, webaclname, terminatingruleid, terminatingruletype, httpsourceid, httpmethod, country, clientip, first_label, uri, account_id, region, action",
                    "refId":"A",
                    "table":"waf_metrics"
                }
            ],
            "title":"Total Requests",
            "transformations":[
                {
                    "id":"convertFieldType",
                    "options":{
                        "conversions":[
                            {
                                "destinationType":"number",
                                "targetField":"requests"
                            }
                        ],
                        "fields":{

                        }
                    }
                }
            ],
            "type":"stat"
        },
        {
            "datasource":{
                "type":"datasource",
                "uid":"-- Dashboard --"
            },
            "fieldConfig":{
                "defaults":{
                    "color":{
                        "mode":"thresholds"
                    },
                    "custom":{
                        "axisCenteredZero":false,
                        "axisColorMode":"text",
                        "axisLabel":"Count",
                        "axisPlacement":"auto",
                        "fillOpacity":80,
                        "gradientMode":"none",
                        "hideFrom":{
                            "legend":false,
                            "tooltip":false,
                            "viz":false
                        },
                        "lineWidth":1,
                        "scaleDistribution":{
                            "type":"linear"
                        },
                        "thresholdsStyle":{
                            "mode":"off"
                        }
                    },
                    "decimals":0,
                    "mappings":[

                    ],
                    "noValue":"0",
                    "thresholds":{
                        "mode":"absolute",
                        "steps":[
                            {
                                "color":"green",
                                "value":null
                            },
                            {
                                "color":"red",
                                "value":80
                            }
                        ]
                    },
                    "unit":"short"
                },
                "overrides":[
                    {
                        "matcher":{
                            "id":"byName",
                            "options":"allowed"
                        },
                        "properties":[
                            {
                                "id":"color",
                                "value":{
                                    "fixedColor":"green",
                                    "mode":"fixed"
                                }
                            },
                            {
                                "id":"displayName",
                                "value":"Allowed"
                            }
                        ]
                    },
                    {
                        "matcher":{
                            "id":"byName",
                            "options":"blocked"
                        },
                        "properties":[
                            {
                                "id":"color",
                                "value":{
                                    "fixedColor":"red",
                                    "mode":"fixed"
                                }
                            },
                            {
                                "id":"displayName",
                                "value":"Blocked"
                            }
                        ]
                    },
                    {
                        "matcher":{
                            "id":"byName",
                            "options":"captcha"
                        },
                        "properties":[
                            {
                                "id":"color",
                                "value":{
                                    "fixedColor":"orange",
                                    "mode":"fixed"
                                }
                            },
                            {
                                "id":"displayName",
                                "value":"Captcha"
                            }
                        ]
                    }
                ]
            },
            "gridPos":{
                "h":12,
                "w":14,
                "x":5,
                "y":1
            },
            "id":4,
            "options":{
                "barRadius":0,
                "barWidth":0.84,
                "fullHighlight":false,
                "groupWidth":0.7,
                "legend":{
                    "calcs":[
                        "lastNotNull"
                    ],
                    "displayMode":"list",
                    "placement":"bottom",
                    "showLegend":true
                },
                "orientation":"auto",
                "showValue":"never",
                "stacking":"normal",
                "tooltip":{
                    "mode":"multi",
                    "sort":"none"
                },
                "xField":"time",
                "xTickLabelRotation":0,
                "xTickLabelSpacing":100
            },
            "pluginVersion":"9.3.6",
            "targets":[
                {
                    "datasource":{
                        "type":"datasource",
                        "uid":"-- Dashboard --"
                    },
                    "panelId":2,
                    "refId":"A",
                    "withTransforms":true
                }
            ],
            "title":"Requests History",
            "transformations":[
                {
                    "id":"groupBy",
                    "options":{
                        "fields":{
                            "action":{
                                "aggregations":[

                                ],
                                "operation":"groupby"
                            },
                            "allowed":{
                                "aggregations":[
                                    "sum"
                                ],
                                "operation":"aggregate"
                            },
                            "blocked":{
                                "aggregations":[
                                    "sum"
                                ],
                                "operation":"aggregate"
                            },
                            "requests":{
                                "aggregations":[
                                    "sum"
                                ],
                                "operation":"aggregate"
                            },
                            "time":{
                                "aggregations":[

                                ],
                                "operation":"groupby"
                            }
                        }
                    }
                },
                {
                    "disabled":true,
                    "id":"calculateField",
                    "options":{
                        "alias":"Action",
                        "mode":"reduceRow",
                        "reduce":{
                            "include":[
                                "requests (sum)"
                            ],
                            "reducer":"sum"
                        },
                        "replaceFields":false
                    }
                },
                {
                    "id":"groupingToMatrix",
                    "options":{
                        "columnField":"action",
                        "rowField":"time",
                        "valueField":"requests (sum)"
                    }
                },
                {
                    "id":"convertFieldType",
                    "options":{
                        "conversions":[
                            {
                                "destinationType":"time",
                                "targetField":"time\\action"
                            }
                        ],
                        "fields":{

                        }
                    }
                },
                {
                    "id":"organize",
                    "options":{
                        "excludeByName":{
                            "ALLOW":false
                        },
                        "indexByName":{
                            "ALLOW":1,
                            "BLOCK":2,
                            "time\\action":0
                        },
                        "renameByName":{
                            "ALLOW":"allowed",
                            "BLOCK":"blocked",
                            "CAPTCHA":"captcha",
                            "time\\action":"time"
                        }
                    }
                }
            ],
            "type":"barchart"
        },
        {
            "datasource":{
                "type":"datasource",
                "uid":"-- Dashboard --"
            },
            "fieldConfig":{
                "defaults":{
                    "color":{
                        "fixedColor":"text",
                        "mode":"palette-classic"
                    },
                    "custom":{
                        "hideFrom":{
                            "legend":false,
                            "tooltip":false,
                            "viz":false
                        }
                    },
                    "decimals":0,
                    "mappings":[

                    ],
                    "unit":"locale"
                },
                "overrides":[
                    {
                        "matcher":{
                            "id":"byName",
                            "options":"webaclname"
                        },
                        "properties":[
                            {
                                "id":"displayName",
                                "value":"WebAclName"
                            }
                        ]
                    }
                ]
            },
            "gridPos":{
                "h":9,
                "w":5,
                "x":19,
                "y":1
            },
            "id":5,
            "options":{
                "displayLabels":[
                    "percent"
                ],
                "legend":{
                    "displayMode":"list",
                    "placement":"bottom",
                    "showLegend":true,
                    "values":[
                        "value"
                    ]
                },
                "pieType":"donut",
                "reduceOptions":{
                    "calcs":[
                        "sum"
                    ],
                    "fields":"/^requests \\(sum\\)$/",
                    "values":true
                },
                "tooltip":{
                    "mode":"single",
                    "sort":"none"
                }
            },
            "pluginVersion":"9.3.6",
            "targets":[
                {
                    "datasource":{
                        "type":"datasource",
                        "uid":"-- Dashboard --"
                    },
                    "panelId":2,
                    "refId":"A",
                    "withTransforms":true
                }
            ],
            "title":"WAF ACLs",
            "transformations":[
                {
                    "id":"groupBy",
                    "options":{
                        "fields":{
                            "allowed":{
                                "aggregations":[
                                    "sum"
                                ]
                            },
                            "blocked":{
                                "aggregations":[
                                    "sum"
                                ]
                            },
                            "requests":{
                                "aggregations":[
                                    "sum"
                                ],
                                "operation":"aggregate"
                            },
                            "time":{
                                "aggregations":[

                                ]
                            },
                            "web_acl_id":{
                                "aggregations":[

                                ]
                            },
                            "web_acl_name":{
                                "aggregations":[

                                ],
                                "operation":"groupby"
                            },
                            "webaclname":{
                                "aggregations":[

                                ],
                                "operation":"groupby"
                            }
                        }
                    }
                },
                {
                    "id":"sortBy",
                    "options":{
                        "fields":{

                        },
                        "sort":[
                            {
                                "desc":true,
                                "field":"requests (sum)"
                            }
                        ]
                    }
                },
                {
                    "id":"limit",
                    "options":{
                        "limitField":10
                    }
                }
            ],
            "type":"piechart"
        },
        {
            "datasource":{
                "type":"datasource",
                "uid":"-- Dashboard --"
            },
            "fieldConfig":{
                "defaults":{
                    "color":{
                        "fixedColor":"text",
                        "mode":"fixed"
                    },
                    "decimals":0,
                    "mappings":[

                    ],
                    "thresholds":{
                        "mode":"absolute",
                        "steps":[
                            {
                                "color":"green",
                                "value":null
                            },
                            {
                                "color":"red",
                                "value":80
                            }
                        ]
                    },
                    "unit":"short"
                },
                "overrides":[

                ]
            },
            "gridPos":{
                "h":6,
                "w":5,
                "x":0,
                "y":7
            },
            "id":3,
            "options":{
                "colorMode":"value",
                "graphMode":"none",
                "justifyMode":"center",
                "orientation":"auto",
                "reduceOptions":{
                    "calcs":[
                        "sum"
                    ],
                    "fields":"/^requests$/",
                    "values":false
                },
                "text":{

                },
                "textMode":"auto"
            },
            "pluginVersion":"10.0.0",
            "targets":[
                {
                    "datasource":{
                        "type":"datasource",
                        "uid":"-- Dashboard --"
                    },
                    "panelId":2,
                    "refId":"A",
                    "withTransforms":true
                }
            ],
            "title":"Total Blocked Requests",
            "transformations":[
                {
                    "id":"filterByValue",
                    "options":{
                        "filters":[
                            {
                                "config":{
                                    "id":"equal",
                                    "options":{
                                        "value":"BLOCK"
                                    }
                                },
                                "fieldName":"action"
                            }
                        ],
                        "match":"all",
                        "type":"include"
                    }
                }
            ],
            "type":"stat"
        },
        {
            "datasource":{
                "type":"datasource",
                "uid":"-- Dashboard --"
            },
            "fieldConfig":{
                "defaults":{
                    "color":{
                        "fixedColor":"text",
                        "mode":"palette-classic"
                    },
                    "custom":{
                        "hideFrom":{
                            "legend":false,
                            "tooltip":false,
                            "viz":false
                        }
                    },
                    "decimals":0,
                    "mappings":[

                    ],
                    "unit":"locale"
                },
                "overrides":[

                ]
            },
            "gridPos":{
                "h":9,
                "w":5,
                "x":19,
                "y":10
            },
            "id":8,
            "options":{
                "displayLabels":[
                    "percent"
                ],
                "legend":{
                    "displayMode":"list",
                    "placement":"bottom",
                    "showLegend":true,
                    "values":[
                        "value"
                    ]
                },
                "pieType":"donut",
                "reduceOptions":{
                    "calcs":[
                        "sum"
                    ],
                    "fields":"/^requests \\(sum\\)$/",
                    "values":true
                },
                "tooltip":{
                    "mode":"single",
                    "sort":"none"
                }
            },
            "pluginVersion":"9.3.6",
            "targets":[
                {
                    "datasource":{
                        "type":"datasource",
                        "uid":"-- Dashboard --"
                    },
                    "panelId":2,
                    "refId":"A",
                    "withTransforms":true
                }
            ],
            "title":"WAF Rules",
            "transformations":[
                {
                    "id":"groupBy",
                    "options":{
                        "fields":{
                            "requests":{
                                "aggregations":[
                                    "sum"
                                ],
                                "operation":"aggregate"
                            },
                            "terminating_rule_id":{
                                "aggregations":[

                                ],
                                "operation":"groupby"
                            },
                            "terminatingruleid":{
                                "aggregations":[

                                ],
                                "operation":"groupby"
                            },
                            "time":{
                                "aggregations":[

                                ]
                            },
                            "webaclname":{
                                "aggregations":[

                                ]
                            }
                        }
                    }
                },
                {
                    "id":"sortBy",
                    "options":{
                        "fields":{

                        },
                        "sort":[
                            {
                                "desc":true,
                                "field":"requests (sum)"
                            }
                        ]
                    }
                },
                {
                    "id":"limit",
                    "options":{
                        "limitField":10
                    }
                }
            ],
            "type":"piechart"
        },
        {
            "datasource":{
                "type":"datasource",
                "uid":"-- Dashboard --"
            },
            "fieldConfig":{
                "defaults":{
                    "color":{
                        "mode":"continuous-BlYlRd"
                    },
                    "custom":{
                        "hideFrom":{
                            "legend":false,
                            "tooltip":false,
                            "viz":false
                        }
                    },
                    "mappings":[

                    ],
                    "thresholds":{
                        "mode":"percentage",
                        "steps":[
                            {
                                "color":"dark-orange",
                                "value":null
                            },
                            {
                                "color":"rgba(237, 129, 40, 0.89)",
                                "value":0
                            },
                            {
                                "color":"rgba(50, 172, 45, 0.97)",
                                "value":10
                            }
                        ]
                    },
                    "unit":"short"
                },
                "overrides":[
                    {
                        "matcher":{
                            "id":"byName",
                            "options":"requests (sum)"
                        },
                        "properties":[
                            {
                                "id":"displayName",
                                "value":"Count"
                            }
                        ]
                    }
                ]
            },
            "gridPos":{
                "h":25,
                "w":19,
                "x":0,
                "y":13
            },
            "id":6,
            "maxDataPoints":1,
            "options":{
                "basemap":{
                    "config":{

                    },
                    "name":"Basemap",
                    "type":"default"
                },
                "controls":{
                    "mouseWheelZoom":false,
                    "showAttribution":true,
                    "showDebug":false,
                    "showMeasure":false,
                    "showScale":false,
                    "showZoom":true
                },
                "layers":[
                    {
                        "config":{
                            "rules":[

                            ],
                            "src":"public/maps/countries.geojson",
                            "style":{
                                "color":{
                                    "fixed":"#37872D"
                                },
                                "opacity":0.4,
                                "rotation":{
                                    "fixed":0,
                                    "max":360,
                                    "min":-360,
                                    "mode":"mod"
                                },
                                "size":{
                                    "fixed":5,
                                    "max":15,
                                    "min":2
                                },
                                "symbol":{
                                    "fixed":"img/icons/marker/circle.svg",
                                    "mode":"fixed"
                                },
                                "textConfig":{
                                    "fontSize":12,
                                    "offsetX":0,
                                    "offsetY":0,
                                    "textAlign":"center",
                                    "textBaseline":"middle"
                                }
                            }
                        },
                        "location":{
                            "mode":"auto"
                        },
                        "name":"GeoJson",
                        "opacity":0.5,
                        "tooltip":false,
                        "type":"geojson"
                    },
                    {
                        "config":{
                            "showLegend":false,
                            "style":{
                                "color":{
                                    "field":"requests (sum)",
                                    "fixed":"red"
                                },
                                "opacity":0.4,
                                "rotation":{
                                    "fixed":0,
                                    "max":360,
                                    "min":-360,
                                    "mode":"mod"
                                },
                                "size":{
                                    "field":"requests (sum)",
                                    "fixed":5,
                                    "max":30,
                                    "min":5
                                },
                                "symbol":{
                                    "fixed":"img/icons/marker/circle.svg",
                                    "mode":"fixed"
                                },
                                "text":{
                                    "field":"requests (sum)",
                                    "fixed":"",
                                    "mode":"field"
                                },
                                "textConfig":{
                                    "fontSize":12,
                                    "offsetX":0,
                                    "offsetY":0,
                                    "textAlign":"center",
                                    "textBaseline":"middle"
                                }
                            }
                        },
                        "location":{
                            "mode":"auto"
                        },
                        "name":"Data",
                        "tooltip":true,
                        "type":"markers"
                    }
                ],
                "tooltip":{
                    "mode":"details"
                },
                "view":{
                    "allLayers":true,
                    "id":"fit",
                    "lastOnly":false,
                    "lat":0,
                    "layer":"Geo Data",
                    "lon":0,
                    "padding":5,
                    "zoom":7
                }
            },
            "pluginVersion":"10.0.0",
            "targets":[
                {
                    "datasource":{
                        "type":"datasource",
                        "uid":"-- Dashboard --"
                    },
                    "panelId":2,
                    "refId":"A",
                    "withTransforms":true
                }
            ],
            "title":"Country or Region By Blocked Requests",
            "transformations":[
                {
                    "id":"filterByValue",
                    "options":{
                        "filters":[
                            {
                                "config":{
                                    "id":"equal",
                                    "options":{
                                        "value":"BLOCK"
                                    }
                                },
                                "fieldName":"action"
                            }
                        ],
                        "match":"all",
                        "type":"include"
                    }
                },
                {
                    "id":"groupBy",
                    "options":{
                        "fields":{
                            "country":{
                                "aggregations":[

                                ],
                                "operation":"groupby"
                            },
                            "requests":{
                                "aggregations":[
                                    "sum"
                                ],
                                "operation":"aggregate"
                            },
                            "terminatingruleid":{
                                "aggregations":[

                                ]
                            },
                            "time":{
                                "aggregations":[

                                ]
                            },
                            "webaclname":{
                                "aggregations":[

                                ]
                            }
                        }
                    }
                },
                {
                    "id":"spatial",
                    "options":{
                        "action":"prepare",
                        "source":{
                            "gazetteer":"public/gazetteer/countries.json",
                            "geohash":"country",
                            "latitude":"requests (sum)",
                            "lookup":"country",
                            "mode":"lookup"
                        }
                    }
                }
            ],
            "type":"geomap"
        },
        {
            "datasource":{
                "type":"datasource",
                "uid":"-- Dashboard --"
            },
            "fieldConfig":{
                "defaults":{
                    "color":{
                        "fixedColor":"text",
                        "mode":"palette-classic"
                    },
                    "custom":{
                        "hideFrom":{
                            "legend":false,
                            "tooltip":false,
                            "viz":false
                        }
                    },
                    "decimals":0,
                    "mappings":[

                    ],
                    "unit":"locale"
                },
                "overrides":[

                ]
            },
            "gridPos":{
                "h":9,
                "w":5,
                "x":19,
                "y":19
            },
            "id":7,
            "options":{
                "displayLabels":[
                    "percent"
                ],
                "legend":{
                    "displayMode":"list",
                    "placement":"bottom",
                    "showLegend":true,
                    "values":[
                        "value"
                    ]
                },
                "pieType":"donut",
                "reduceOptions":{
                    "calcs":[
                        "sum"
                    ],
                    "fields":"/^requests \\(sum\\)$/",
                    "values":true
                },
                "tooltip":{
                    "mode":"single",
                    "sort":"none"
                }
            },
            "pluginVersion":"9.3.6",
            "targets":[
                {
                    "datasource":{
                        "type":"datasource",
                        "uid":"-- Dashboard --"
                    },
                    "panelId":2,
                    "refId":"A",
                    "withTransforms":true
                }
            ],
            "title":"Sources",
            "transformations":[
                {
                    "id":"groupBy",
                    "options":{
                        "fields":{
                            "http_source_id":{
                                "aggregations":[

                                ],
                                "operation":"groupby"
                            },
                            "httpsourceid":{
                                "aggregations":[

                                ],
                                "operation":"groupby"
                            },
                            "requests":{
                                "aggregations":[
                                    "sum"
                                ],
                                "operation":"aggregate"
                            },
                            "time":{
                                "aggregations":[

                                ]
                            },
                            "webaclname":{
                                "aggregations":[

                                ]
                            }
                        }
                    }
                },
                {
                    "id":"sortBy",
                    "options":{
                        "fields":{

                        },
                        "sort":[
                            {
                                "desc":true,
                                "field":"requests (sum)"
                            }
                        ]
                    }
                },
                {
                    "id":"limit",
                    "options":{
                        "limitField":10
                    }
                }
            ],
            "type":"piechart"
        },
        {
            "datasource":{
                "type":"datasource",
                "uid":"-- Dashboard --"
            },
            "fieldConfig":{
                "defaults":{
                    "color":{
                        "fixedColor":"text",
                        "mode":"palette-classic"
                    },
                    "custom":{
                        "hideFrom":{
                            "legend":false,
                            "tooltip":false,
                            "viz":false
                        }
                    },
                    "decimals":0,
                    "mappings":[

                    ],
                    "unit":"locale"
                },
                "overrides":[

                ]
            },
            "gridPos":{
                "h":10,
                "w":5,
                "x":19,
                "y":28
            },
            "id":9,
            "options":{
                "displayLabels":[
                    "percent"
                ],
                "legend":{
                    "displayMode":"list",
                    "placement":"bottom",
                    "showLegend":true,
                    "values":[
                        "value"
                    ]
                },
                "pieType":"donut",
                "reduceOptions":{
                    "calcs":[
                        "sum"
                    ],
                    "fields":"/^requests \\(sum\\)$/",
                    "values":true
                },
                "tooltip":{
                    "mode":"single",
                    "sort":"none"
                }
            },
            "pluginVersion":"9.3.6",
            "targets":[
                {
                    "datasource":{
                        "type":"datasource",
                        "uid":"-- Dashboard --"
                    },
                    "panelId":2,
                    "refId":"A",
                    "withTransforms":true
                }
            ],
            "title":"HTTP Methods",
            "transformations":[
                {
                    "id":"groupBy",
                    "options":{
                        "fields":{
                            "http_method":{
                                "aggregations":[

                                ],
                                "operation":"groupby"
                            },
                            "httpmethod":{
                                "aggregations":[

                                ],
                                "operation":"groupby"
                            },
                            "httpsourceid":{
                                "aggregations":[

                                ]
                            },
                            "requests":{
                                "aggregations":[
                                    "sum"
                                ],
                                "operation":"aggregate"
                            },
                            "time":{
                                "aggregations":[

                                ]
                            },
                            "webaclname":{
                                "aggregations":[

                                ]
                            }
                        }
                    }
                },
                {
                    "id":"sortBy",
                    "options":{
                        "fields":{

                        },
                        "sort":[
                            {
                                "desc":true,
                                "field":"requests (sum)"
                            }
                        ]
                    }
                },
                {
                    "id":"limit",
                    "options":{
                        "limitField":10
                    }
                }
            ],
            "type":"piechart"
        },
        {
            "collapsed":false,
            "gridPos":{
                "h":1,
                "w":24,
                "x":0,
                "y":38
            },
            "id":21,
            "panels":[

            ],
            "title":"Top 5",
            "type":"row"
        },
        {
            "datasource":{
                "type":"datasource",
                "uid":"-- Dashboard --"
            },
            "description":"",
            "fieldConfig":{
                "defaults":{
                    "color":{
                        "mode":"thresholds"
                    },
                    "custom":{
                        "align":"center",
                        "cellOptions":{
                            "type":"color-text"
                        },
                        "filterable":true,
                        "inspect":true
                    },
                    "mappings":[

                    ],
                    "min":-3,
                    "thresholds":{
                        "mode":"absolute",
                        "steps":[
                            {
                                "color":"green"
                            },
                            {
                                "color":"red",
                                "value":80
                            }
                        ]
                    },
                    "unit":"short"
                },
                "overrides":[
                    {
                        "matcher":{
                            "id":"byName",
                            "options":"requests (sum)"
                        },
                        "properties":[
                            {
                                "id":"displayName",
                                "value":"Count"
                            }
                        ]
                    },
                    {
                        "matcher":{
                            "id":"byName",
                            "options":"webaclid"
                        },
                        "properties":[
                            {
                                "id":"displayName",
                                "value":"Web ACL ID"
                            }
                        ]
                    },
                    {
                        "matcher":{
                            "id":"byName",
                            "options":"webaclname"
                        },
                        "properties":[
                            {
                                "id":"displayName",
                                "value":"Web ACL Name"
                            }
                        ]
                    }
                ]
            },
            "gridPos":{
                "h":8,
                "w":6,
                "x":0,
                "y":39
            },
            "id":10,
            "options":{
                "cellHeight":"sm",
                "footer":{
                    "countRows":false,
                    "enablePagination":false,
                    "fields":"",
                    "reducer":[
                        "sum"
                    ],
                    "show":false
                },
                "showHeader":true
            },
            "pluginVersion":"10.0.0",
            "targets":[
                {
                    "datasource":{
                        "type":"datasource",
                        "uid":"-- Dashboard --"
                    },
                    "panelId":2,
                    "refId":"A",
                    "withTransforms":true
                }
            ],
            "title":"Top WebACLs",
            "transformations":[
                {
                    "id":"groupBy",
                    "options":{
                        "fields":{
                            "requests":{
                                "aggregations":[
                                    "sum"
                                ],
                                "operation":"aggregate"
                            },
                            "time":{
                                "aggregations":[

                                ]
                            },
                            "web_acl_id":{
                                "aggregations":[

                                ],
                                "operation":"groupby"
                            },
                            "web_acl_name":{
                                "aggregations":[

                                ],
                                "operation":"groupby"
                            },
                            "webaclid":{
                                "aggregations":[

                                ],
                                "operation":"groupby"
                            },
                            "webaclname":{
                                "aggregations":[

                                ],
                                "operation":"groupby"
                            }
                        }
                    }
                },
                {
                    "id":"sortBy",
                    "options":{
                        "fields":{

                        },
                        "sort":[
                            {
                                "desc":true,
                                "field":"requests (sum)"
                            }
                        ]
                    }
                },
                {
                    "id":"limit",
                    "options":{
                        "limitField":5
                    }
                }
            ],
            "type":"table"
        },
        {
            "datasource":{
                "type":"datasource",
                "uid":"-- Dashboard --"
            },
            "description":"",
            "fieldConfig":{
                "defaults":{
                    "color":{
                        "mode":"thresholds"
                    },
                    "custom":{
                        "align":"center",
                        "cellOptions":{
                            "type":"color-text"
                        },
                        "filterable":true,
                        "inspect":true
                    },
                    "mappings":[

                    ],
                    "min":-3,
                    "thresholds":{
                        "mode":"absolute",
                        "steps":[
                            {
                                "color":"green"
                            },
                            {
                                "color":"red",
                                "value":80
                            }
                        ]
                    },
                    "unit":"short"
                },
                "overrides":[
                    {
                        "matcher":{
                            "id":"byName",
                            "options":"requests (sum)"
                        },
                        "properties":[
                            {
                                "id":"displayName",
                                "value":"Count"
                            }
                        ]
                    },
                    {
                        "matcher":{
                            "id":"byName",
                            "options":"httpsourceid"
                        },
                        "properties":[
                            {
                                "id":"displayName",
                                "value":"Http Source Id"
                            }
                        ]
                    }
                ]
            },
            "gridPos":{
                "h":8,
                "w":6,
                "x":6,
                "y":39
            },
            "id":14,
            "options":{
                "cellHeight":"sm",
                "footer":{
                    "countRows":false,
                    "enablePagination":false,
                    "fields":"",
                    "reducer":[
                        "sum"
                    ],
                    "show":false
                },
                "showHeader":true
            },
            "pluginVersion":"10.0.0",
            "targets":[
                {
                    "datasource":{
                        "type":"datasource",
                        "uid":"-- Dashboard --"
                    },
                    "panelId":2,
                    "refId":"A",
                    "withTransforms":true
                }
            ],
            "title":"Top Sources",
            "transformations":[
                {
                    "id":"groupBy",
                    "options":{
                        "fields":{
                            "host":{
                                "aggregations":[

                                ]
                            },
                            "httpsourceid":{
                                "aggregations":[

                                ],
                                "operation":"groupby"
                            },
                            "requests":{
                                "aggregations":[
                                    "sum"
                                ],
                                "operation":"aggregate"
                            },
                            "time":{
                                "aggregations":[

                                ]
                            },
                            "webaclid":{
                                "aggregations":[

                                ]
                            },
                            "webaclname":{
                                "aggregations":[

                                ]
                            }
                        }
                    }
                },
                {
                    "id":"sortBy",
                    "options":{
                        "fields":{

                        },
                        "sort":[
                            {
                                "desc":true,
                                "field":"requests (sum)"
                            }
                        ]
                    }
                },
                {
                    "id":"limit",
                    "options":{
                        "limitField":5
                    }
                }
            ],
            "type":"table"
        },
        {
            "datasource":{
                "type":"datasource",
                "uid":"-- Dashboard --"
            },
            "description":"",
            "fieldConfig":{
                "defaults":{
                    "color":{
                        "mode":"thresholds"
                    },
                    "custom":{
                        "align":"center",
                        "cellOptions":{
                            "type":"color-text"
                        },
                        "filterable":true,
                        "inspect":true
                    },
                    "mappings":[

                    ],
                    "min":-3,
                    "thresholds":{
                        "mode":"absolute",
                        "steps":[
                            {
                                "color":"green"
                            },
                            {
                                "color":"red",
                                "value":80
                            }
                        ]
                    },
                    "unit":"short"
                },
                "overrides":[
                    {
                        "matcher":{
                            "id":"byName",
                            "options":"requests (sum)"
                        },
                        "properties":[
                            {
                                "id":"displayName",
                                "value":"Count"
                            }
                        ]
                    },
                    {
                        "matcher":{
                            "id":"byName",
                            "options":"uri"
                        },
                        "properties":[
                            {
                                "id":"displayName",
                                "value":"httpRequest.uri"
                            }
                        ]
                    }
                ]
            },
            "gridPos":{
                "h":8,
                "w":6,
                "x":12,
                "y":39
            },
            "id":12,
            "options":{
                "cellHeight":"sm",
                "footer":{
                    "countRows":false,
                    "enablePagination":false,
                    "fields":"",
                    "reducer":[
                        "sum"
                    ],
                    "show":false
                },
                "showHeader":true
            },
            "pluginVersion":"10.0.0",
            "targets":[
                {
                    "datasource":{
                        "type":"datasource",
                        "uid":"-- Dashboard --"
                    },
                    "panelId":2,
                    "refId":"A",
                    "withTransforms":true
                }
            ],
            "title":"Top Request URIs",
            "transformations":[
                {
                    "id":"groupBy",
                    "options":{
                        "fields":{
                            "host":{
                                "aggregations":[

                                ]
                            },
                            "httpsourceid":{
                                "aggregations":[

                                ]
                            },
                            "requests":{
                                "aggregations":[
                                    "sum"
                                ],
                                "operation":"aggregate"
                            },
                            "time":{
                                "aggregations":[

                                ]
                            },
                            "uri":{
                                "aggregations":[

                                ],
                                "operation":"groupby"
                            },
                            "url":{
                                "aggregations":[

                                ],
                                "operation":"groupby"
                            },
                            "webaclid":{
                                "aggregations":[

                                ]
                            },
                            "webaclname":{
                                "aggregations":[

                                ]
                            }
                        }
                    }
                },
                {
                    "id":"sortBy",
                    "options":{
                        "fields":{

                        },
                        "sort":[
                            {
                                "desc":true,
                                "field":"requests (sum)"
                            }
                        ]
                    }
                },
                {
                    "id":"limit",
                    "options":{
                        "limitField":5
                    }
                }
            ],
            "type":"table"
        },
        {
            "datasource":{
                "type":"datasource",
                "uid":"-- Dashboard --"
            },
            "description":"",
            "fieldConfig":{
                "defaults":{
                    "color":{
                        "mode":"thresholds"
                    },
                    "custom":{
                        "align":"center",
                        "cellOptions":{
                            "type":"color-text"
                        },
                        "filterable":true,
                        "inspect":true
                    },
                    "mappings":[

                    ],
                    "min":-3,
                    "thresholds":{
                        "mode":"absolute",
                        "steps":[
                            {
                                "color":"green"
                            },
                            {
                                "color":"red",
                                "value":80
                            }
                        ]
                    },
                    "unit":"short"
                },
                "overrides":[
                    {
                        "matcher":{
                            "id":"byName",
                            "options":"requests (sum)"
                        },
                        "properties":[
                            {
                                "id":"displayName",
                                "value":"Count"
                            }
                        ]
                    },
                    {
                        "matcher":{
                            "id":"byName",
                            "options":"country"
                        },
                        "properties":[
                            {
                                "id":"displayName",
                                "value":"Country or Region"
                            }
                        ]
                    }
                ]
            },
            "gridPos":{
                "h":8,
                "w":6,
                "x":18,
                "y":39
            },
            "id":13,
            "options":{
                "cellHeight":"sm",
                "footer":{
                    "countRows":false,
                    "enablePagination":false,
                    "fields":"",
                    "reducer":[
                        "sum"
                    ],
                    "show":false
                },
                "showHeader":true
            },
            "pluginVersion":"10.0.0",
            "targets":[
                {
                    "datasource":{
                        "type":"datasource",
                        "uid":"-- Dashboard --"
                    },
                    "panelId":2,
                    "refId":"A",
                    "withTransforms":true
                }
            ],
            "title":"Top Countries or Regions",
            "transformations":[
                {
                    "id":"groupBy",
                    "options":{
                        "fields":{
                            "country":{
                                "aggregations":[

                                ],
                                "operation":"groupby"
                            },
                            "host":{
                                "aggregations":[

                                ]
                            },
                            "httpsourceid":{
                                "aggregations":[

                                ]
                            },
                            "requests":{
                                "aggregations":[
                                    "sum"
                                ],
                                "operation":"aggregate"
                            },
                            "time":{
                                "aggregations":[

                                ]
                            },
                            "webaclid":{
                                "aggregations":[

                                ]
                            },
                            "webaclname":{
                                "aggregations":[

                                ]
                            }
                        }
                    }
                },
                {
                    "id":"sortBy",
                    "options":{
                        "fields":{

                        },
                        "sort":[
                            {
                                "desc":true,
                                "field":"requests (sum)"
                            }
                        ]
                    }
                },
                {
                    "id":"limit",
                    "options":{
                        "limitField":5
                    }
                }
            ],
            "type":"table"
        },
        {
            "datasource":{
                "type":"datasource",
                "uid":"-- Dashboard --"
            },
            "description":"",
            "fieldConfig":{
                "defaults":{
                    "color":{
                        "mode":"thresholds"
                    },
                    "custom":{
                        "align":"center",
                        "cellOptions":{
                            "type":"color-text"
                        },
                        "filterable":true,
                        "inspect":true
                    },
                    "mappings":[

                    ],
                    "min":-3,
                    "thresholds":{
                        "mode":"absolute",
                        "steps":[
                            {
                                "color":"green"
                            },
                            {
                                "color":"red",
                                "value":80
                            }
                        ]
                    },
                    "unit":"short"
                },
                "overrides":[
                    {
                        "matcher":{
                            "id":"byName",
                            "options":"requests (sum)"
                        },
                        "properties":[
                            {
                                "id":"displayName",
                                "value":"Count"
                            }
                        ]
                    },
                    {
                        "matcher":{
                            "id":"byName",
                            "options":"terminatingruleid"
                        },
                        "properties":[
                            {
                                "id":"displayName",
                                "value":"Terminating Rule Id"
                            }
                        ]
                    },
                    {
                        "matcher":{
                            "id":"byName",
                            "options":"terminatingruletype"
                        },
                        "properties":[
                            {
                                "id":"displayName",
                                "value":"Terminating Rule Type"
                            }
                        ]
                    }
                ]
            },
            "gridPos":{
                "h":8,
                "w":6,
                "x":0,
                "y":47
            },
            "id":11,
            "options":{
                "cellHeight":"sm",
                "footer":{
                    "countRows":false,
                    "enablePagination":false,
                    "fields":"",
                    "reducer":[
                        "sum"
                    ],
                    "show":false
                },
                "showHeader":true
            },
            "pluginVersion":"10.0.0",
            "targets":[
                {
                    "datasource":{
                        "type":"datasource",
                        "uid":"-- Dashboard --"
                    },
                    "panelId":2,
                    "refId":"A",
                    "withTransforms":true
                }
            ],
            "title":"Top Rules",
            "transformations":[
                {
                    "id":"groupBy",
                    "options":{
                        "fields":{
                            "host":{
                                "aggregations":[

                                ]
                            },
                            "requests":{
                                "aggregations":[
                                    "sum"
                                ],
                                "operation":"aggregate"
                            },
                            "terminating_rule_id":{
                                "aggregations":[

                                ],
                                "operation":"groupby"
                            },
                            "terminating_rule_type":{
                                "aggregations":[

                                ],
                                "operation":"groupby"
                            },
                            "terminatingruleid":{
                                "aggregations":[

                                ],
                                "operation":"groupby"
                            },
                            "terminatingruletype":{
                                "aggregations":[

                                ],
                                "operation":"groupby"
                            },
                            "time":{
                                "aggregations":[

                                ]
                            },
                            "webaclid":{
                                "aggregations":[

                                ]
                            },
                            "webaclname":{
                                "aggregations":[

                                ]
                            }
                        }
                    }
                },
                {
                    "id":"sortBy",
                    "options":{
                        "fields":{

                        },
                        "sort":[
                            {
                                "desc":true,
                                "field":"requests (sum)"
                            }
                        ]
                    }
                },
                {
                    "id":"limit",
                    "options":{
                        "limitField":5
                    }
                }
            ],
            "type":"table"
        },
        {
            "datasource":{
                "type":"datasource",
                "uid":"-- Dashboard --"
            },
            "description":"",
            "fieldConfig":{
                "defaults":{
                    "color":{
                        "mode":"thresholds"
                    },
                    "custom":{
                        "align":"center",
                        "cellOptions":{
                            "type":"color-text"
                        },
                        "filterable":true,
                        "inspect":true
                    },
                    "mappings":[

                    ],
                    "min":-3,
                    "thresholds":{
                        "mode":"absolute",
                        "steps":[
                            {
                                "color":"green"
                            },
                            {
                                "color":"red",
                                "value":80
                            }
                        ]
                    },
                    "unit":"short"
                },
                "overrides":[
                    {
                        "matcher":{
                            "id":"byName",
                            "options":"requests (sum)"
                        },
                        "properties":[
                            {
                                "id":"displayName",
                                "value":"Count"
                            }
                        ]
                    },
                    {
                        "matcher":{
                            "id":"byName",
                            "options":"clientip"
                        },
                        "properties":[
                            {
                                "id":"displayName",
                                "value":"httpRequest.clientIp"
                            }
                        ]
                    }
                ]
            },
            "gridPos":{
                "h":8,
                "w":6,
                "x":6,
                "y":47
            },
            "id":15,
            "options":{
                "cellHeight":"sm",
                "footer":{
                    "countRows":false,
                    "enablePagination":false,
                    "fields":"",
                    "reducer":[
                        "sum"
                    ],
                    "show":false
                },
                "showHeader":true
            },
            "pluginVersion":"10.0.0",
            "targets":[
                {
                    "datasource":{
                        "type":"datasource",
                        "uid":"-- Dashboard --"
                    },
                    "panelId":2,
                    "refId":"A",
                    "withTransforms":true
                }
            ],
            "title":"Top Client IPs",
            "transformations":[
                {
                    "id":"groupBy",
                    "options":{
                        "fields":{
                            "clientip":{
                                "aggregations":[

                                ],
                                "operation":"groupby"
                            },
                            "host":{
                                "aggregations":[

                                ]
                            },
                            "requests":{
                                "aggregations":[
                                    "sum"
                                ],
                                "operation":"aggregate"
                            },
                            "src_endpoint_ip":{
                                "aggregations":[

                                ],
                                "operation":"groupby"
                            },
                            "terminatingruleid":{
                                "aggregations":[

                                ]
                            },
                            "time":{
                                "aggregations":[

                                ]
                            },
                            "webaclid":{
                                "aggregations":[

                                ]
                            },
                            "webaclname":{
                                "aggregations":[

                                ]
                            }
                        }
                    }
                },
                {
                    "id":"sortBy",
                    "options":{
                        "fields":{

                        },
                        "sort":[
                            {
                                "desc":true,
                                "field":"requests (sum)"
                            }
                        ]
                    }
                },
                {
                    "id":"limit",
                    "options":{
                        "limitField":5
                    }
                }
            ],
            "type":"table"
        },
        {
            "datasource":{
                "type":"datasource",
                "uid":"-- Dashboard --"
            },
            "description":"",
            "fieldConfig":{
                "defaults":{
                    "color":{
                        "mode":"thresholds"
                    },
                    "custom":{
                        "align":"center",
                        "cellOptions":{
                            "type":"color-text"
                        },
                        "filterable":true,
                        "inspect":true
                    },
                    "mappings":[

                    ],
                    "min":-3,
                    "thresholds":{
                        "mode":"absolute",
                        "steps":[
                            {
                                "color":"green"
                            },
                            {
                                "color":"red",
                                "value":80
                            }
                        ]
                    },
                    "unit":"short"
                },
                "overrides":[
                    {
                        "matcher":{
                            "id":"byName",
                            "options":"requests (sum)"
                        },
                        "properties":[
                            {
                                "id":"displayName",
                                "value":"Count"
                            }
                        ]
                    },
                    {
                        "matcher":{
                            "id":"byName",
                            "options":"hostname"
                        },
                        "properties":[
                            {
                                "id":"displayName",
                                "value":"Host Name"
                            }
                        ]
                    },
                    {
                        "matcher":{
                            "id":"byName",
                            "options":"url"
                        },
                        "properties":[
                            {
                                "id":"displayName",
                                "value":"httpRequest.uri"
                            }
                        ]
                    },
                    {
                        "matcher":{
                            "id":"byName",
                            "options":"action"
                        },
                        "properties":[
                            {
                                "id":"displayName",
                                "value":"Action"
                            }
                        ]
                    }
                ]
            },
            "gridPos":{
                "h":8,
                "w":6,
                "x":12,
                "y":47
            },
            "id":16,
            "options":{
                "cellHeight":"sm",
                "footer":{
                    "countRows":false,
                    "enablePagination":false,
                    "fields":"",
                    "reducer":[
                        "sum"
                    ],
                    "show":false
                },
                "showHeader":true
            },
            "pluginVersion":"10.0.0",
            "targets":[
                {
                    "datasource":{
                        "type":"datasource",
                        "uid":"-- Dashboard --"
                    },
                    "panelId":2,
                    "refId":"A",
                    "withTransforms":true
                }
            ],
            "title":"Top  Blocked / Allowed Host URI",
            "transformations":[
                {
                    "id":"groupBy",
                    "options":{
                        "fields":{
                            "action":{
                                "aggregations":[

                                ],
                                "operation":"groupby"
                            },
                            "host":{
                                "aggregations":[

                                ],
                                "operation":"groupby"
                            },
                            "hostname":{
                                "aggregations":[

                                ],
                                "operation":"groupby"
                            },
                            "requests":{
                                "aggregations":[
                                    "sum"
                                ],
                                "operation":"aggregate"
                            },
                            "terminatingruleid":{
                                "aggregations":[

                                ]
                            },
                            "time":{
                                "aggregations":[

                                ]
                            },
                            "uri":{
                                "aggregations":[

                                ],
                                "operation":"groupby"
                            },
                            "url":{
                                "aggregations":[

                                ],
                                "operation":"groupby"
                            },
                            "webaclid":{
                                "aggregations":[

                                ]
                            },
                            "webaclname":{
                                "aggregations":[

                                ]
                            }
                        }
                    }
                },
                {
                    "disabled":true,
                    "id":"filterByValue",
                    "options":{
                        "filters":[
                            {
                                "config":{
                                    "id":"equal",
                                    "options":{
                                        "value":"BLOCK"
                                    }
                                },
                                "fieldName":"action"
                            }
                        ],
                        "match":"all",
                        "type":"include"
                    }
                },
                {
                    "id":"sortBy",
                    "options":{
                        "fields":{

                        },
                        "sort":[
                            {
                                "desc":true,
                                "field":"requests (sum)"
                            }
                        ]
                    }
                },
                {
                    "id":"limit",
                    "options":{
                        "limitField":5
                    }
                }
            ],
            "type":"table"
        },
        {
            "datasource":{
                "type":"datasource",
                "uid":"-- Dashboard --"
            },
            "description":"",
            "fieldConfig":{
                "defaults":{
                    "color":{
                        "mode":"thresholds"
                    },
                    "custom":{
                        "align":"center",
                        "cellOptions":{
                            "type":"color-text"
                        },
                        "filterable":true,
                        "inspect":true
                    },
                    "mappings":[

                    ],
                    "min":-3,
                    "thresholds":{
                        "mode":"absolute",
                        "steps":[
                            {
                                "color":"green"
                            },
                            {
                                "color":"red",
                                "value":80
                            }
                        ]
                    },
                    "unit":"short"
                },
                "overrides":[
                    {
                        "matcher":{
                            "id":"byName",
                            "options":"requests (sum)"
                        },
                        "properties":[
                            {
                                "id":"displayName",
                                "value":"Count"
                            }
                        ]
                    },
                    {
                        "matcher":{
                            "id":"byName",
                            "options":"host"
                        },
                        "properties":[
                            {
                                "id":"displayName",
                                "value":"Host"
                            }
                        ]
                    },
                    {
                        "matcher":{
                            "id":"byName",
                            "options":"first_label"
                        },
                        "properties":[
                            {
                                "id":"displayName",
                                "value":"Label"
                            }
                        ]
                    },
                    {
                        "matcher":{
                            "id":"byName",
                            "options":"uri"
                        },
                        "properties":[
                            {
                                "id":"displayName",
                                "value":"httpRequest.uri"
                            }
                        ]
                    }
                ]
            },
            "gridPos":{
                "h":8,
                "w":6,
                "x":18,
                "y":47
            },
            "id":17,
            "options":{
                "cellHeight":"sm",
                "footer":{
                    "countRows":false,
                    "enablePagination":false,
                    "fields":"",
                    "reducer":[
                        "sum"
                    ],
                    "show":false
                },
                "showHeader":true
            },
            "pluginVersion":"10.0.0",
            "targets":[
                {
                    "datasource":{
                        "type":"datasource",
                        "uid":"-- Dashboard --"
                    },
                    "panelId":2,
                    "refId":"A",
                    "withTransforms":true
                }
            ],
            "title":"Top Labels with Host, URI",
            "transformations":[
                {
                    "id":"groupBy",
                    "options":{
                        "fields":{
                            "first_label":{
                                "aggregations":[

                                ],
                                "operation":"groupby"
                            },
                            "host":{
                                "aggregations":[

                                ],
                                "operation":"groupby"
                            },
                            "requests":{
                                "aggregations":[
                                    "sum"
                                ],
                                "operation":"aggregate"
                            },
                            "terminatingruleid":{
                                "aggregations":[

                                ]
                            },
                            "time":{
                                "aggregations":[

                                ]
                            },
                            "uri":{
                                "aggregations":[

                                ],
                                "operation":"groupby"
                            },
                            "url":{
                                "aggregations":[

                                ],
                                "operation":"groupby"
                            },
                            "webaclid":{
                                "aggregations":[

                                ]
                            },
                            "webaclname":{
                                "aggregations":[

                                ]
                            }
                        }
                    }
                },
                {
                    "disabled":true,
                    "id":"filterByValue",
                    "options":{
                        "filters":[
                            {
                                "config":{
                                    "id":"isNotNull",
                                    "options":{

                                    }
                                },
                                "fieldName":"first_label"
                            },
                            {
                                "config":{
                                    "id":"notEqual",
                                    "options":{
                                        "value":""
                                    }
                                },
                                "fieldName":"first_label"
                            }
                        ],
                        "match":"all",
                        "type":"include"
                    }
                },
                {
                    "id":"sortBy",
                    "options":{
                        "fields":{

                        },
                        "sort":[
                            {
                                "desc":true,
                                "field":"requests (sum)"
                            }
                        ]
                    }
                },
                {
                    "id":"limit",
                    "options":{
                        "limitField":5
                    }
                },
                {
                    "id":"organize",
                    "options":{
                        "excludeByName":{

                        },
                        "indexByName":{
                            "first_label":0,
                            "requests (sum)":2,
                            "uri":1
                        },
                        "renameByName":{
                            "first_label":""
                        }
                    }
                }
            ],
            "type":"table"
        },
        {
            "collapsed":false,
            "gridPos":{
                "h":1,
                "w":24,
                "x":0,
                "y":55
            },
            "id":23,
            "panels":[

            ],
            "title":"Metrics",
            "type":"row"
        },
        {
            "datasource":{
                "type":"datasource",
                "uid":"-- Dashboard --"
            },
            "fieldConfig":{
                "defaults":{
                    "color":{
                        "mode":"palette-classic"
                    },
                    "custom":{
                        "align":"auto",
                        "cellOptions":{
                            "type":"color-text"
                        },
                        "filterable":true,
                        "inspect":false
                    },
                    "mappings":[

                    ],
                    "thresholds":{
                        "mode":"absolute",
                        "steps":[
                            {
                                "color":"green"
                            },
                            {
                                "color":"red",
                                "value":80
                            }
                        ]
                    }
                },
                "overrides":[
                    {
                        "matcher":{
                            "id":"byName",
                            "options":"time"
                        },
                        "properties":[
                            {
                                "id":"custom.width",
                                "value":215
                            }
                        ]
                    },
                    {
                        "matcher":{
                            "id":"byName",
                            "options":"webaclid"
                        },
                        "properties":[
                            {
                                "id":"displayName",
                                "value":"Web ACL Id"
                            }
                        ]
                    },
                    {
                        "matcher":{
                            "id":"byName",
                            "options":"webaclname"
                        },
                        "properties":[
                            {
                                "id":"displayName",
                                "value":"Web ACL Name"
                            }
                        ]
                    },
                    {
                        "matcher":{
                            "id":"byName",
                            "options":"terminatingruleid"
                        },
                        "properties":[
                            {
                                "id":"displayName",
                                "value":"Terminating Rule Id"
                            }
                        ]
                    },
                    {
                        "matcher":{
                            "id":"byName",
                            "options":"terminatingruletype"
                        },
                        "properties":[
                            {
                                "id":"displayName",
                                "value":"Terminating Rule Type"
                            }
                        ]
                    },
                    {
                        "matcher":{
                            "id":"byName",
                            "options":"httpsourceid"
                        },
                        "properties":[
                            {
                                "id":"displayName",
                                "value":"Http Source Id"
                            }
                        ]
                    },
                    {
                        "matcher":{
                            "id":"byName",
                            "options":"httpmethod"
                        },
                        "properties":[
                            {
                                "id":"displayName",
                                "value":"Http Method"
                            }
                        ]
                    },
                    {
                        "matcher":{
                            "id":"byName",
                            "options":"country"
                        },
                        "properties":[
                            {
                                "id":"displayName",
                                "value":"Country"
                            }
                        ]
                    },
                    {
                        "matcher":{
                            "id":"byName",
                            "options":"hostname"
                        },
                        "properties":[
                            {
                                "id":"displayName",
                                "value":"Host Name"
                            }
                        ]
                    },
                    {
                        "matcher":{
                            "id":"byName",
                            "options":"clientip"
                        },
                        "properties":[
                            {
                                "id":"displayName",
                                "value":"HttpRequest.clientIp"
                            }
                        ]
                    },
                    {
                        "matcher":{
                            "id":"byName",
                            "options":"first_label"
                        },
                        "properties":[
                            {
                                "id":"displayName",
                                "value":"First Lable"
                            }
                        ]
                    },
                    {
                        "matcher":{
                            "id":"byName",
                            "options":"uri"
                        },
                        "properties":[
                            {
                                "id":"displayName",
                                "value":"HttpRequest.uri"
                            }
                        ]
                    },
                    {
                        "matcher":{
                            "id":"byName",
                            "options":"account_id"
                        },
                        "properties":[
                            {
                                "id":"displayName",
                                "value":"Account Id"
                            }
                        ]
                    }
                ]
            },
            "gridPos":{
                "h":18,
                "w":24,
                "x":0,
                "y":56
            },
            "id":25,
            "options":{
                "cellHeight":"sm",
                "footer":{
                    "countRows":false,
                    "enablePagination":true,
                    "fields":"",
                    "reducer":[
                        "sum"
                    ],
                    "show":false
                },
                "showHeader":true,
                "sortBy":[

                ]
            },
            "pluginVersion":"10.0.0",
            "targets":[
                {
                    "datasource":{
                        "type":"datasource",
                        "uid":"-- Dashboard --"
                    },
                    "panelId":2,
                    "refId":"A",
                    "withTransforms":true
                }
            ],
            "transformations":[
                {
                    "id":"organize",
                    "options":{
                        "excludeByName":{

                        },
                        "indexByName":{
                            "account_id":1,
                            "action":14,
                            "clientip":11,
                            "country":9,
                            "first_label":12,
                            "hostname":10,
                            "httpmethod":8,
                            "httpsourceid":7,
                            "region":2,
                            "requests":15,
                            "terminatingruleid":5,
                            "terminatingruletype":6,
                            "time":0,
                            "uri":13,
                            "webaclid":3,
                            "webaclname":4
                        },
                        "renameByName":{

                        }
                    }
                },
                {
                    "id":"sortBy",
                    "options":{
                        "fields":{

                        },
                        "sort":[
                            {
                                "desc":true,
                                "field":"time"
                            }
                        ]
                    }
                }
            ],
            "type":"table"
        }
    ],
    "refresh":"5m",
    "revision":1,
    "schemaVersion":38,
    "style":"dark",
    "tags":[

    ],
    "templating":{
        "list":[
            {
                "current":{
                    "selected":false,
                    "text":"123456789012",
                    "value":"123456789012"
                },
                "datasource":{
                    "type":"grafana-athena-datasource",
                    "uid":"Bn93a3_Vk"
                },
                "definition":"",
                "hide":0,
                "includeAll":false,
                "label":"Account Id",
                "multi":false,
                "name":"account_id",
                "options":[

                ],
                "query":{
                    "connectionArgs":{
                        "catalog":"__default",
                        "database":"__default",
                        "region":"__default",
                        "resultReuseEnabled":true,
                        "resultReuseMaxAgeInMinutes":5
                    },
                    "format":1,
                    "rawSQL":"SELECT account_id\nFROM \"$__table\" \nWHERE  event_hour BETWEEN  $__rawTimeFrom('yyyyMMddHH') AND  $__rawTimeTo('yyyyMMddHH')\n\tOR event_hour = $__rawTimeFrom('yyyyMMdd00')\nGROUP BY account_id",
                    "table":"waf_metrics"
                },
                "refresh":2,
                "regex":"",
                "skipUrlSync":false,
                "sort":0,
                "type":"query"
            },
            {
                "current":{
                    "selected":false,
                    "text":"us-east-1",
                    "value":"us-east-1"
                },
                "datasource":{
                    "type":"grafana-athena-datasource",
                    "uid":"Bn93a3_Vk"
                },
                "definition":"",
                "hide":0,
                "includeAll":false,
                "label":"Region",
                "multi":false,
                "name":"region",
                "options":[

                ],
                "query":{
                    "connectionArgs":{
                        "catalog":"__default",
                        "database":"__default",
                        "region":"__default",
                        "resultReuseEnabled":true,
                        "resultReuseMaxAgeInMinutes":5
                    },
                    "format":1,
                    "rawSQL":"SELECT region\nFROM \"$__table\" \nWHERE  event_hour BETWEEN  $__rawTimeFrom('yyyyMMddHH') AND  $__rawTimeTo('yyyyMMddHH')\n\tOR event_hour = $__rawTimeFrom('yyyyMMdd00')\nGROUP BY region",
                    "table":"waf_metrics"
                },
                "refresh":2,
                "regex":"",
                "skipUrlSync":false,
                "sort":0,
                "type":"query"
            },
            {
                "current":{
                    "selected":false,
                    "text":[
                        "All"
                    ],
                    "value":[
                        "$__all"
                    ]
                },
                "hide":0,
                "includeAll":true,
                "label":"Action",
                "multi":true,
                "name":"action",
                "options":[
                    {
                        "selected":true,
                        "text":"All",
                        "value":"$__all"
                    },
                    {
                        "selected":false,
                        "text":"ALLOW",
                        "value":"ALLOW"
                    },
                    {
                        "selected":false,
                        "text":"BLOCK",
                        "value":"BLOCK"
                    },
                    {
                        "selected":false,
                        "text":"CAPTCHA",
                        "value":"CAPTCHA"
                    },
                    {
                        "selected":false,
                        "text":"Count",
                        "value":"Count"
                    },
                    {
                        "selected":false,
                        "text":"Challenge",
                        "value":"Challenge"
                    }
                ],
                "query":"ALLOW, BLOCK,CAPTCHA,Count,Challenge",
                "queryValue":"",
                "skipUrlSync":false,
                "type":"custom"
            },
            {
                "current":{
                    "selected":true,
                    "text":[
                        "All"
                    ],
                    "value":[
                        "$__all"
                    ]
                },
                "hide":0,
                "includeAll":true,
                "label":"Terminating Rule Type",
                "multi":true,
                "name":"terminatingruletype",
                "options":[
                    {
                        "selected":true,
                        "text":"All",
                        "value":"$__all"
                    },
                    {
                        "selected":false,
                        "text":"RATE_BASED",
                        "value":"RATE_BASED"
                    },
                    {
                        "selected":false,
                        "text":"REGULAR",
                        "value":"REGULAR"
                    },
                    {
                        "selected":false,
                        "text":"GROUP",
                        "value":"GROUP"
                    },
                    {
                        "selected":false,
                        "text":"MANAGED_RULE_GROUP",
                        "value":"MANAGED_RULE_GROUP"
                    }
                ],
                "query":"RATE_BASED, REGULAR, GROUP, MANAGED_RULE_GROUP",
                "queryValue":"",
                "skipUrlSync":false,
                "type":"custom"
            },
            {
                "allValue":"SELECT webaclname FROM \"$__table\" WHERE account_id = (${account_id:sqlstring}) \tAND region = (${region:sqlstring}) \tAND (event_hour BETWEEN  $__rawTimeFrom('yyyyMMddHH') AND  $__rawTimeTo('yyyyMMddHH') \t\tOR event_hour = $__rawTimeFrom('yyyyMMdd00')) GROUP BY webaclname",
                "current":{
                    "selected":false,
                    "text":"All",
                    "value":"$__all"
                },
                "datasource":{
                    "type":"grafana-athena-datasource",
                    "uid":"Bn93a3_Vk"
                },
                "definition":"",
                "hide":0,
                "includeAll":true,
                "label":"Web ACL Name",
                "multi":true,
                "name":"webaclname",
                "options":[

                ],
                "query":{
                    "connectionArgs":{
                        "catalog":"__default",
                        "database":"__default",
                        "region":"__default",
                        "resultReuseEnabled":true,
                        "resultReuseMaxAgeInMinutes":5
                    },
                    "format":1,
                    "rawSQL":"SELECT webaclname\nFROM \"$__table\"\nWHERE account_id = (${account_id:sqlstring})\n\tAND region = (${region:sqlstring})\n\tAND (event_hour BETWEEN  $__rawTimeFrom('yyyyMMddHH') AND  $__rawTimeTo('yyyyMMddHH')\n\t\tOR event_hour = $__rawTimeFrom('yyyyMMdd00'))\nGROUP BY webaclname",
                    "table":"waf_metrics"
                },
                "refresh":2,
                "regex":"",
                "skipUrlSync":false,
                "sort":1,
                "type":"query"
            },
            {
                "allValue":"SELECT httpsourceid FROM \"$__table\" WHERE  account_id = (${account_id:sqlstring}) \tAND region = (${region:sqlstring}) \tAND (event_hour BETWEEN  $__rawTimeFrom('yyyyMMddHH') AND  $__rawTimeTo('yyyyMMddHH') \t\tOR event_hour = $__rawTimeFrom('yyyyMMdd00')) GROUP BY httpsourceid",
                "current":{
                    "selected":false,
                    "text":"All",
                    "value":"$__all"
                },
                "datasource":{
                    "type":"grafana-athena-datasource",
                    "uid":"Bn93a3_Vk"
                },
                "definition":"",
                "hide":0,
                "includeAll":true,
                "label":"Source",
                "multi":true,
                "name":"httpsourceid",
                "options":[

                ],
                "query":{
                    "connectionArgs":{
                        "catalog":"__default",
                        "database":"__default",
                        "region":"__default",
                        "resultReuseEnabled":true,
                        "resultReuseMaxAgeInMinutes":5
                    },
                    "format":1,
                    "rawSQL":"SELECT httpsourceid\nFROM \"$__table\"\nWHERE  account_id = (${account_id:sqlstring})\n\tAND region = (${region:sqlstring})\n\tAND (event_hour BETWEEN  $__rawTimeFrom('yyyyMMddHH') AND  $__rawTimeTo('yyyyMMddHH')\n\t\tOR event_hour = $__rawTimeFrom('yyyyMMdd00'))\nGROUP BY httpsourceid\n\n",
                    "table":"waf_metrics"
                },
                "refresh":2,
                "regex":"",
                "skipUrlSync":false,
                "sort":1,
                "type":"query"
            },
            {
                "allValue":"SELECT terminatingruleid FROM \"$__table\" WHERE  account_id = (${account_id:sqlstring}) \tAND region = (${region:sqlstring}) \tAND (event_hour BETWEEN  $__rawTimeFrom('yyyyMMddHH') AND  $__rawTimeTo('yyyyMMddHH') \t\tOR event_hour = $__rawTimeFrom('yyyyMMdd00')) GROUP BY terminatingruleid",
                "current":{
                    "selected":false,
                    "text":"All",
                    "value":"$__all"
                },
                "datasource":{
                    "type":"grafana-athena-datasource",
                    "uid":"Bn93a3_Vk"
                },
                "definition":"",
                "hide":0,
                "includeAll":true,
                "label":"Rule",
                "multi":true,
                "name":"terminatingruleid",
                "options":[

                ],
                "query":{
                    "connectionArgs":{
                        "catalog":"__default",
                        "database":"__default",
                        "region":"__default",
                        "resultReuseEnabled":true,
                        "resultReuseMaxAgeInMinutes":5
                    },
                    "format":1,
                    "rawSQL":"SELECT terminatingruleid\nFROM \"$__table\"\nWHERE  account_id = (${account_id:sqlstring})\n\tAND region = (${region:sqlstring})\n\tAND (event_hour BETWEEN  $__rawTimeFrom('yyyyMMddHH') AND  $__rawTimeTo('yyyyMMddHH')\n\t\tOR event_hour = $__rawTimeFrom('yyyyMMdd00'))\nGROUP BY terminatingruleid\n\n",
                    "table":"waf_metrics"
                },
                "refresh":2,
                "regex":"",
                "skipUrlSync":false,
                "sort":1,
                "type":"query"
            },
            {
                "auto":true,
                "auto_count":30,
                "auto_min":"1m",
                "current":{
                    "selected":false,
                    "text":"auto",
                    "value":"$__auto_interval_interval"
                },
                "hide":0,
                "label":"Interval",
                "name":"interval",
                "options":[
                    {
                        "selected":true,
                        "text":"auto",
                        "value":"$__auto_interval_interval"
                    },
                    {
                        "selected":false,
                        "text":"1m",
                        "value":"1m"
                    },
                    {
                        "selected":false,
                        "text":"5m",
                        "value":"5m"
                    },
                    {
                        "selected":false,
                        "text":"15m",
                        "value":"15m"
                    },
                    {
                        "selected":false,
                        "text":"30m",
                        "value":"30m"
                    },
                    {
                        "selected":false,
                        "text":"1h",
                        "value":"1h"
                    },
                    {
                        "selected":false,
                        "text":"6h",
                        "value":"6h"
                    },
                    {
                        "selected":false,
                        "text":"12h",
                        "value":"12h"
                    },
                    {
                        "selected":false,
                        "text":"1d",
                        "value":"1d"
                    },
                    {
                        "selected":false,
                        "text":"7d",
                        "value":"7d"
                    },
                    {
                        "selected":false,
                        "text":"14d",
                        "value":"14d"
                    },
                    {
                        "selected":false,
                        "text":"30d",
                        "value":"30d"
                    }
                ],
                "query":"1m,5m,15m,30m,1h,6h,12h,1d,7d,14d,30d",
                "queryValue":"",
                "refresh":2,
                "skipUrlSync":false,
                "type":"interval"
            }
        ]
    },
    "time":{
        "from":"now-30m",
        "to":"now"
    },
    "timepicker":{
        "refresh_intervals":[
            "5m",
            "15m",
            "30m",
            "1h",
            "2h",
            "1d"
        ]
    },
    "timezone":"",
    "title":"waf-dashboard",
    "uid":"bf412f36-d95b-4b80-bcc6-29e775208d2a-01",
    "version":1,
    "weekStart":""
}